- content_for :head do
  = javascript_include_tag "pages/staff/announcements/index-bundle"
  = stylesheet_link_tag "pages/staff/announcements/index-bundle", :media => "all"
  :javascript
    window.keyword = "#{@keyword}"
    window.profile = "#{@profile}"
    window.local_total_page = "#{@local_eles[:total_page]}"
    window.global_total_page = "#{@global_eles[:total_page]}"

.content-area
  .content-box
    .manage-box
      .user-search-box
        .input-group
          %input.form-control#search-input{:type => "text", :placeholder => "输入搜索关键字", :value => "#{@keyword}"}
          %span.input-group-btn
            %button.btn.btn-default#search-btn{:type => "button"}
      .btn.add-btn{:type => "button"} 
        %img.add-img{src: asset_path("managecenter/add.png")}
        添加本区公告
    .manage-content
      .tabbable
        %ul.nav.nav-tabs
          %li.active
            %a{"data-toggle" => "tab", :href => "#tab1"} 本区公告
          %li
            %a#global_announce{"data-toggle" => "tab", :href => "#tab2"} 全局公告

        .tab-content
          #tab1.tab-pane.active
            - if @local_eles[:data].length == 0
              .undiscover
                %img.undiscover-icon{src: asset_path("managecenter/undiscover.png")}
                %span.message 抱歉！暂无公告信息
            - else
              - @local_eles[:data].each do |e|
                .introduce
                  %a{href: "/staff/announcements/" + e.id.to_s}
                    %img.visit{:src => e.photo.present? ? e.photo.path : asset_path("web/announcement.png"), width: "190", height: "129"}
                  %p.caption-header
                    %span.caption= link_to truncate(e.title, length: 25), "/staff/announcements/#{e.id.to_s}"
                    %span#time-flag= e.created_at.strftime("%Y-%m-%d %H-%M")
                    %a.undeclared{:href => "javascript:void(0);"}= e.status_str
                  .desc
                    = e.plain_text
              = render "staff/partials/auto_paginate", locals: { instance: @local_eles, url: "/staff/announcements?profile=local&keyword=#{@keyword}&", page: 'local_page'}

            
          #tab2.tab-pane
            - if @global_eles[:data].length == 0
              .undiscover
                %img.undiscover-icon{src: asset_path("managecenter/undiscover.png")}
                %span.message 抱歉！暂无公告信息
            - else
              - @global_eles[:data].each do |e|
                .introduce
                  %a{href: "/staff/announcements/" + e.id.to_s}
                    %img.visit{:src => e.photo.present? ? e.photo.path : asset_path("web/announcement.png"), width: "190", height: "129"}
                  %p.caption-header
                    %span.caption= link_to truncate(e.title, length: 25), "/staff/announcements/#{e.id.to_s}"
                    %span#time-flag= e.created_at.strftime("%Y-%m-%d %H:%M")
                    %a.undeclared{:href => "javascript:void(0);"}= e.status_str
                  .desc
                    = e.plain_text
              = render "staff/partials/auto_paginate", locals: { instance: @global_eles, url: "/staff/announcements?profile=global&keyword=#{@keyword}&", page: 'global_page'}

           
